stages:
    - dotnetbuild
    - angularbuild
    - dotnetdeploy
     
dotnet-build:
    stage: dotnetbuild
    tags:
        - dotnet
    before_script:
        - cd Backend/MyVirtualCloset
        - dotnet restore
    script:
        - dotnet build
        
dotnet-deploy:
    stage: dotnetdeploy
    tags:
        - shell
    before_script:
        - cd Backend/MyVirtualCloset
        - dotnet restore
        - sudo systemctl daemon-reload
    script:
        - dotnet publish -c release -r linux-x64 -o /var/www/MyVirtualCloset/test --self-contained
        - sudo systemctl stop MyVirtualCloset-backend
        - sudo systemctl start MyVirtualCloset-backend

angular-build:
    image: trion/ng-cli
    stage: angularbuild
    tags:
        - angular
    before_script:
        - cd Frontend/MyVirtualCloset
        - npm install
    script:
        - ng build --prod
    